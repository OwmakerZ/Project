const { groth16 } = require("snarkjs");

async function generateProof() {
    // 1. 准备工作
    const input = {
        privateInput: ["123", "456", "789"],  // 隐私输入(原象)
        publicHash: "哈希计算结果"            // 公开输入(声称的哈希值)
    };
    
    // 2. 计算见证(Witness)
    const { proof, publicSignals } = await groth16.fullProve(
        input,
        "poseidon2_js/poseidon2.wasm",
        "poseidon2_final.zkey"
    );
    
    // 3. 验证证明
    const vKey = JSON.parse(fs.readFileSync("verification_key.json"));
    const res = await groth16.verify(vKey, publicSignals, proof);
    
    console.log("验证结果:", res ? "通过" : "不通过");
    return { proof, publicSignals };
}